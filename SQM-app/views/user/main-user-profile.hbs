{{#if userInSession}}
  <nav class="navbar navbar-expand">
      <div class="navbar-nav">
        {{#if userInSession.main}}
          <div class="nav-item mx-2">
            <a href="/auth/create-user" class="btn btn-success">Add Supplier Account</a>
          </div>
          <div class="nav-item mx-2">
            <a href="/complaint/create" class="btn btn-warning">Add Complaint</a>
          </div>
          <div class="nav-item mx-2">
            <a href="/auth/users-list" class="btn btn-warning">Supplier list</a>
          </div>
        {{/if}}
      </div>
  </nav>

  <h2>Your Profile</h2>
  <h3>Welcome, {{ userInSession.username }}!</h3>
  <p>This is your profile page my friend from {{userInSession.org}}!</p>
  <p>email: {{userInSession.email}}</p>

  {{#if userInSession.main}}
    <p>in Main account</p>
  {{/if}}

  <div class="container-fluid" id="main-table">
    <div id="toolbar">
    </div>
    
    {{#if userInSession.main}}
      <table id="table" class="table table-hover table-dark">
        <thead>
          <tr>
            <th scope="col">Complaint ID</th>
            <th scope="col">Report ID</th>
            <th scope="col">Part Number</th>
            <th scope="col">Supplier</th>
            <th scope="col">Creation date</th>
            <th scope="col">Report approval</th>
            <td scope="col"></td>
          </tr>
        </thead>
        <tbody>
          {{#each allComplaints}}
          <tr>
            <td><a class="btn btn-outline-primary"href="/complaint/{{_id}}/details">{{_id}}</a></td>
            <td><a class="btn btn-outline-info" href="/report/{{report._id}}/details">{{report._id}}</a></td>
            <td>{{partNumber}}</td>
            <td>{{userId.org}}</td>
            <td class="date-type">{{createdAt}}</td>
            <td>
              {{#if report.approval}}
              Approved
              {{else}}
              On-going
              {{/if}}
            </td>
            <td>
              {{!-- Modal button to POST delete Compalint --}}
              <button type="button" class="btn btn-outline-danger" data-bs-toggle="modal" data-bs-target="#deleteComplaint{{_id}}">Delete</button>
              {{!-- Modal POST to delete Complaint and all related data to it--}}
              <div class="modal fade" id="deleteComplaint{{_id}}" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
                <div class="modal-dialog form-section">
                  <form class="modal-content bg-dark" action="/complaint/{{_id}}/delete" method="POST">
                    <div class="modal-header">
                      <h1 class="modal-title fs-5 text-danger fw-bold" id="staticBackdropLabel">Are you sure?</h1>
                    </div>      
                    <div class="modal-body">
                      <p>
                        <strong>Please confirm deletion of Complaint {{_id}}</strong>
                        <br><br>
                        <strong class="text-warning fs-sm">This will also delete the Related Report and Actions to this Complaint</strong>
                      </p>
                    </div>
                    <div class="modal-footer">
                      <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                      <button class="btn btn-outline-danger" type="submit">Confirm</button>
                    </div>
                  </form>
                </div>
              </div>
            </td>
          </tr>
          {{/each}}
        </tbody>
      </table>
    {{else}}
      <table id="table" class="table table-hover table-dark">
        <thead>
          <tr>
            <th scope="col">Complaint ID</th>
            <th scope="col">Report ID</th>
            <th scope="col">Creation date</th>
            <th scope="col">Approval</th>
          </tr>
        </thead>
        <tbody>
          {{#each allComplaints}}
          <tr>
            <td><a class="btn btn-outline-primary" href="/report/{{_id}}/details">{{_id}}</a></td>
            <td><a class="btn btn-outline-info" href="/report/{{report._id}}/details">{{report._id}}</a></td>
            <td class="date-type">{{report.createdAt}}</td>
            <td>
              {{#if report.approval}}
              Approved
              {{else}}
              On-going
              {{/if}}
            </td>
          </tr>
          {{/each}}
        </tbody>
      </table>
    {{/if}}
  </div>
{{else}}
  <br><p>Still no logged in user, sorry!</p>
{{/if}}